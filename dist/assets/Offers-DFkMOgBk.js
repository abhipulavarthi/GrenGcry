import{d as k,r,e as O,a as E,j as e,L as I}from"./index-BLFxWsoH.js";function P(){const{role:f}=k(s=>s.auth),l=r.useMemo(()=>f==="admin",[f]),[p]=O(),j=E(),b=r.useMemo(()=>[{name:"Basmati Rice 5kg",img:"https://source.unsplash.com/300x300/?rice",price:18.99,mrp:24.99},{name:"Olive Oil 1L",img:"https://source.unsplash.com/300x300/?olive,oil",price:9.49,mrp:12.99},{name:"Corn Flakes 1kg",img:"https://source.unsplash.com/300x300/?cereal",price:3.99,mrp:5.49},{name:"Paneer 200g",img:"https://source.unsplash.com/300x300/?paneer",price:2.19,mrp:2.99},{name:"Ground Coffee 250g",img:"https://source.unsplash.com/300x300/?coffee",price:4.79,mrp:6.49},{name:"Mixed Biscuits Pack",img:"https://source.unsplash.com/300x300/?biscuits",price:1.69,mrp:2.49},{name:"Green Tea 100ct",img:"https://source.unsplash.com/300x300/?tea",price:3.49,mrp:4.99},{name:"Detergent Liquid 1L",img:"https://source.unsplash.com/300x300/?detergent",price:2.89,mrp:3.79},{name:"Tomato Ketchup 1kg",img:"https://source.unsplash.com/300x300/?ketchup",price:2.19,mrp:2.99},{name:"Sunflower Oil 1L",img:"https://source.unsplash.com/300x300/?sunflower,oil",price:3.99,mrp:5.49},{name:"Chana Dal 1kg",img:"https://source.unsplash.com/300x300/?lentils",price:2.39,mrp:3.19},{name:"Pasta 500g",img:"https://source.unsplash.com/300x300/?pasta",price:1.29,mrp:1.99}],[]),[y,N]=r.useState(()=>{try{const s=JSON.parse(localStorage.getItem("saleItems")||"null");return Array.isArray(s)?s:b}catch{return b}}),[F,u]=r.useState(!1),[S,x]=r.useState(!1);r.useEffect(()=>{const s=p.get("action");l&&(s==="add-sale"&&u(!0),s==="add-discount"&&x(!0))},[p,l]);const[a,o]=r.useState({name:"",img:"",price:"",mrp:""}),[h,g]=r.useState({title:"",percent:""}),m=()=>{u(!1),x(!1);const s=new URLSearchParams(p);s.delete("action"),j({search:s.toString()},{replace:!0})},w=s=>{s.preventDefault();const t=parseFloat(a.price),d=parseFloat(a.mrp);!a.name||isNaN(t)||isNaN(d)||(N(i=>{const n=[{name:a.name,img:a.img||"https://source.unsplash.com/300x300/?grocery",price:t,mrp:d},...i];localStorage.setItem("saleItems",JSON.stringify(n));try{const c=Object.fromEntries(n.map(v=>[v.name,v.price]));localStorage.setItem("saleOverrides",JSON.stringify(c))}catch{}return n}),o({name:"",img:"",price:"",mrp:""}),m())},C=s=>{s.preventDefault(),console.log("New discount rule",h),g({title:"",percent:""}),m()};return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Offers"}),l&&e.jsx("div",{className:"mb-4 rounded",style:{backgroundColor:"#F2F0EF"},children:e.jsxs("div",{className:"p-3 flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>u(!0),className:"px-3 py-2 rounded bg-[#6F4E37] text-white",children:"Add Sale Product"}),e.jsx("button",{onClick:()=>x(!0),className:"px-3 py-2 rounded border-2 border-[#6F4E37] text-[#6F4E37] hover:bg-[#6F4E37] hover:text-white transition",children:"Add Discount"})]})}),e.jsx("section",{className:"mt-8",children:e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:y.map((s,t)=>e.jsxs("div",{className:"relative",children:[l&&e.jsx("button",{onClick:()=>{N(d=>{const i=d.filter((n,c)=>c!==t);localStorage.setItem("saleItems",JSON.stringify(i));try{const n=Object.fromEntries(i.map(c=>[c.name,c.price]));localStorage.setItem("saleOverrides",JSON.stringify(n))}catch{}return i})},title:"Remove from sale",className:"absolute top-2 right-2 z-10 px-2 py-1 text-xs bg-red-600 text-white rounded",children:"Remove"}),e.jsxs(I,{to:`/products?q=${encodeURIComponent(s.name.split(" ")[0])}`,className:"block border rounded-lg overflow-hidden bg-white hover:shadow-sm",children:[e.jsx("img",{className:"w-full aspect-square object-cover",src:s.img,alt:s.name}),e.jsxs("div",{className:"px-3 py-2 text-sm",children:[e.jsx("div",{className:"font-medium truncate",title:s.name,children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[#6F4E37] font-semibold",children:["$",s.price.toFixed(2)]}),e.jsxs("span",{className:"text-xs line-through text-gray-500",children:["$",s.mrp.toFixed(2)]})]})]})]})]},t))})}),l&&F&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"w-full max-w-md rounded shadow-lg",style:{backgroundColor:"#F2F0EF"},children:[e.jsx("div",{className:"p-4 border-b font-semibold",style:{backgroundColor:"#F2F0EF"},children:"Add Sale Product"}),e.jsxs("form",{onSubmit:w,className:"p-4 space-y-3",children:[e.jsx("input",{value:a.name,onChange:s=>o(t=>({...t,name:s.target.value})),placeholder:"Name",className:"w-full border rounded px-3 py-2"}),e.jsx("input",{value:a.img,onChange:s=>o(t=>({...t,img:s.target.value})),placeholder:"Image URL (optional)",className:"w-full border rounded px-3 py-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{value:a.price,onChange:s=>o(t=>({...t,price:s.target.value})),placeholder:"Price",type:"number",step:"0.01",className:"w-full border rounded px-3 py-2"}),e.jsx("input",{value:a.mrp,onChange:s=>o(t=>({...t,mrp:s.target.value})),placeholder:"MRP",type:"number",step:"0.01",className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{type:"button",onClick:m,className:"px-3 py-2 border rounded",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-[#6F4E37] text-white",children:"Add"})]})]})]})}),l&&S&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"w-full max-w-md rounded shadow-lg",style:{backgroundColor:"#F2F0EF"},children:[e.jsx("div",{className:"p-4 border-b font-semibold",style:{backgroundColor:"#F2F0EF"},children:"Add Discount"}),e.jsxs("form",{onSubmit:C,className:"p-4 space-y-3",children:[e.jsx("input",{value:h.title,onChange:s=>g(t=>({...t,title:s.target.value})),placeholder:"Discount Title (e.g., Festive Sale)",className:"w-full border rounded px-3 py-2"}),e.jsx("input",{value:h.percent,onChange:s=>g(t=>({...t,percent:s.target.value})),placeholder:"Percent (%)",type:"number",step:"1",className:"w-full border rounded px-3 py-2"}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{type:"button",onClick:m,className:"px-3 py-2 border rounded",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-3 py-2 rounded bg-[#6F4E37] text-white",children:"Save"})]})]})]})})]})}export{P as default};
