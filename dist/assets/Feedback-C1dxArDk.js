import{r as d,d as g,c as r,j as e,B as o}from"./index-BLFxWsoH.js";import{u as f,o as N,c as v,a as l,b as w}from"./index.esm-7R15jc3W.js";const y=v({productId:l().required(),rating:w().min(1).max(5).required(),comment:l().required()});function R(){const[m,x]=d.useState([]),[u,n]=d.useState([]),{register:c,handleSubmit:b,reset:p,formState:{errors:a,isSubmitting:i}}=f({resolver:N(y)}),{role:h}=g(s=>s.auth);d.useEffect(()=>{(async()=>{try{const s=await r.get("/products");x(s.data||[]);const t=await r.get("/feedback");n(t.data||[])}catch{}})()},[]);const j=async s=>{try{await r.post("/feedback",s),o.success("Thanks for your feedback!"),p();const t=await r.get("/feedback");n(t.data||[])}catch{o.error("Submit failed")}};return e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Leave a Review"}),e.jsxs("form",{onSubmit:b(j),className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Product"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2 bg-transparent",...c("productId"),children:[e.jsx("option",{value:"",children:"Select"}),m.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),a.productId&&e.jsx("p",{className:"text-sm text-brand-brown",children:a.productId.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Rating (1-5)"}),e.jsx("input",{type:"number",min:"1",max:"5",className:"w-full border rounded px-3 py-2 bg-transparent",...c("rating")}),a.rating&&e.jsx("p",{className:"text-sm text-brand-brown",children:a.rating.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1",children:"Comment"}),e.jsx("textarea",{rows:"4",className:"w-full border rounded px-3 py-2 bg-transparent",...c("comment")}),a.comment&&e.jsx("p",{className:"text-sm text-brand-brown",children:a.comment.message})]}),e.jsx("button",{disabled:i,className:"px-4 py-2 bg-[#6F4E37] text-white rounded",children:i?"...":"Submit"})]})]}),h==="admin"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Recent Reviews"}),e.jsx("div",{className:"space-y-3",children:u.map((s,t)=>e.jsxs("div",{className:"border rounded p-3 dark:border-gray-800",children:[e.jsx("div",{className:"font-medium",children:s.productName||s.productId}),e.jsxs("div",{className:"text-brand-sand",children:["★".repeat(s.rating),"☆".repeat(5-s.rating)]}),e.jsx("p",{className:"text-sm mt-1",children:s.comment})]},t))})]})]})}export{R as default};
