import{h as w,r as l,c as y,B as m,j as e}from"./index-BLFxWsoH.js";function I(){var b,j;const{orderId:c}=w(),[a,x]=l.useState(null),[r,i]=l.useState("upi"),[h,N]=l.useState(""),[t,n]=l.useState({number:"",name:"",expiry:"",cvv:""}),[u,p]=l.useState(!1),g=l.useRef(null);l.useEffect(()=>{(async()=>{try{const s=await y.get(`/orders/${c}`);x(s.data)}catch{m.error("Failed to load order")}})()},[c]);const v=()=>{window.print()},f=async()=>{var s,d;if(a){p(!0);try{const o=r==="upi"?{upiId:h}:r==="card"?{card:t}:{cod:!0};await y.post(`/orders/${c}/pay`,{method:r,...o}),m.success("Payment successful"),x({...a,status:"paid"})}catch(o){m.error(((d=(s=o.response)==null?void 0:s.data)==null?void 0:d.message)||"Payment failed")}finally{p(!1)}}};return a?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h1",{className:"text-2xl font-semibold",children:["Invoice #",a.id]}),e.jsx("button",{onClick:v,className:"px-3 py-2 bg-brand-aqua text-white rounded",children:"Print / Download"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{ref:g,className:"border rounded p-4 dark:border-gray-800 bg-white text-gray-9 00 print:bg-white print:text-black",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"GroceryMS"}),e.jsx("div",{className:"text-sm text-gray-500",children:"invoice@groceryms.local"})]}),e.jsxs("div",{className:"text-sm",children:["Date: ",new Date(a.createdAt||Date.now()).toLocaleString()]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"font-medium",children:"Bill To:"}),e.jsx("div",{children:((b=a.customer)==null?void 0:b.name)||"Customer"})]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"py-2",children:"Item"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Total"})]})}),e.jsx("tbody",{children:(j=a.items)==null?void 0:j.map((s,d)=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:s.name}),e.jsxs("td",{children:[s.qty,s.unitLabel?` (${s.unitLabel})`:""]}),e.jsx("td",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s.price)}),e.jsx("td",{children:new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s.price*s.qty)})]},d))})]}),e.jsxs("div",{className:"text-right font-semibold mt-3",children:["Grand Total: ",new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a.total)]})]})}),e.jsxs("aside",{className:"border rounded p-4 dark:border-gray-800 h-fit",children:[e.jsx("h2",{className:"font-semibold mb-3",children:"Payment"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"paymethod",checked:r==="upi",onChange:()=>i("upi")}),e.jsx("span",{children:"UPI"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"paymethod",checked:r==="card",onChange:()=>i("card")}),e.jsx("span",{children:"Credit / Debit Card"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"paymethod",checked:r==="cod",onChange:()=>i("cod")}),e.jsx("span",{children:"Cash on Delivery"})]})]}),r==="upi"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm mb-1",children:"UPI ID"}),e.jsx("input",{value:h,onChange:s=>N(s.target.value),className:"w-full border rounded px-3 py-2 bg-transparent",placeholder:"name@bank"})]}),r==="card"&&e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Card Number"}),e.jsx("input",{value:t.number,onChange:s=>n({...t,number:s.target.value}),className:"w-full border rounded px-3 py-2 bg-transparent",placeholder:"1234 5678 9012 3456"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Name on Card"}),e.jsx("input",{value:t.name,onChange:s=>n({...t,name:s.target.value}),className:"w-full border rounded px-3 py-2 bg-transparent",placeholder:"Full Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Expiry"}),e.jsx("input",{value:t.expiry,onChange:s=>n({...t,expiry:s.target.value}),className:"w-full border rounded px-3 py-2 bg-transparent",placeholder:"MM/YY"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"CVV"}),e.jsx("input",{value:t.cvv,onChange:s=>n({...t,cvv:s.target.value}),className:"w-full border rounded px-3 py-2 bg-transparent",placeholder:"123"})]})]})]})]}),r==="cod"&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Pay in cash when your order is delivered. Additional COD fee may apply."}),e.jsx("button",{disabled:u,onClick:f,className:"w-full py-2 rounded bg-brand-steel text-white disabled:opacity-50",children:u?"Processing...":"Pay Now"}),a.status==="paid"&&e.jsx("div",{className:"mt-2 text-brand-aqua text-sm",children:"Payment received"})]})]})]}):e.jsx("div",{children:"Loading..."})}export{I as default};
